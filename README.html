<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="data:text/css,%0A%40font%2Dface%20%7B%0Afont%2Dfamily%3A%20octicons%2Dlink%3B%0Asrc%3A%20url%28data%3Afont%2Fwoff%3Bcharset%3Dutf%2D8%3Bbase64%2Cd09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM%2B8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB%2FaFGpk3jaTY6xa8JAGMW%2FO62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v%2Bk%2F0an2i%2BitHDw3v2%2B9%2BDBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3%2FI7AtxEJLtzzuZfI%2BVVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy%2FLt7Kc%2B0vWY%2FgAgIIEqAN9we0pwKXreiMasxvabDQMM4riO%2BqxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw%2Bymhce7vwM9jSqO8JyVd5RH9gyTt2%2BJ%2FyUmYlIR0s04n6%2B7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv%2FocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi%2BW2%2BMjCzMIDApSwvXzC97Z4Ig8N%2FBxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh%2F8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT%2BAEjAwuDFpBmA9KMDEwMCh9i%2Fv8H8sH0%2F4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9%2FlqYwOGZxeUelN2U2R6%2BcArgtCJpauW7UQBqnFkUsjAY%2FkOU1cP%2BDAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl%2BvvmM%2FbyA48e6tWrKArm4ZJlCbdsrxksL1AwWn%2FyBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO%2F%2FsdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd%2F89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF%2B9JOS0nbaaYDCQfwCJ7Au3AHj%2BLO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm%2BEBXuAbHmIMSRMs%2B4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL%2BhD7C1xoaHeLJSEao0FEW14ckxC%2BTU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13%2F%2Blm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl%2B9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O%2FAdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB%2F%2F%2FAA8AAQAAAAAAAAAAAAAAAAABAAAAAA%3D%3D%29%20format%28%27woff%27%29%3B%0A%7D%0Abody%20%7B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0Atext%2Dsize%2Dadjust%3A%20100%25%3B%0Acolor%3A%20%23333%3B%0Afont%2Dfamily%3A%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20%22Segoe%20UI%22%2C%20Arial%2C%20freesans%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0Afont%2Dsize%3A%2016px%3B%0Aline%2Dheight%3A%201%2E6%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0A%7D%0Aa%20%7B%0Abackground%2Dcolor%3A%20transparent%3B%0A%7D%0Aa%3Aactive%2C%0Aa%3Ahover%20%7B%0Aoutline%3A%200%3B%0A%7D%0Astrong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%202em%3B%0Amargin%3A%200%2E67em%200%3B%0A%7D%0Aimg%20%7B%0Aborder%3A%200%3B%0A%7D%0Ahr%20%7B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Aheight%3A%200%3B%0A%7D%0Apre%20%7B%0Aoverflow%3A%20auto%3B%0A%7D%0Acode%2C%0Akbd%2C%0Apre%20%7B%0Afont%2Dfamily%3A%20monospace%2C%20monospace%3B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ainput%20%7B%0Acolor%3A%20inherit%3B%0Afont%3A%20inherit%3B%0Amargin%3A%200%3B%0A%7D%0Ahtml%20input%5Bdisabled%5D%20%7B%0Acursor%3A%20default%3B%0A%7D%0Ainput%20%7B%0Aline%2Dheight%3A%20normal%3B%0A%7D%0Ainput%5Btype%3D%22checkbox%22%5D%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Apadding%3A%200%3B%0A%7D%0Atable%20%7B%0Aborder%2Dcollapse%3A%20collapse%3B%0Aborder%2Dspacing%3A%200%3B%0A%7D%0Atd%2C%0Ath%20%7B%0Apadding%3A%200%3B%0A%7D%0A%2A%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0Ainput%20%7B%0Afont%3A%2013px%20%2F%201%2E4%20Helvetica%2C%20arial%2C%20nimbussansl%2C%20liberationsans%2C%20freesans%2C%20clean%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%234078c0%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%2C%0Aa%3Aactive%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%200%3B%0Amargin%3A%2015px%200%3B%0Aoverflow%3A%20hidden%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0Ahr%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ahr%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%2015px%3B%0Amargin%2Dbottom%3A%2015px%3B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%2030px%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%2021px%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%2016px%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%2011px%3B%0A%7D%0Ablockquote%20%7B%0Amargin%3A%200%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aol%20ol%2C%0Aul%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Droman%3B%0A%7D%0Aul%20ul%20ol%2C%0Aul%20ol%20ol%2C%0Aol%20ul%20ol%2C%0Aol%20ol%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Dalpha%3B%0A%7D%0Add%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0Afont%3A%2012px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0A%7D%0A%2Eselect%3A%3A%2Dms%2Dexpand%20%7B%0Aopacity%3A%200%3B%0A%7D%0A%2Eocticon%20%7B%0Afont%3A%20normal%20normal%20normal%2016px%2F1%20octicons%2Dlink%3B%0Adisplay%3A%20inline%2Dblock%3B%0Atext%2Ddecoration%3A%20none%3B%0Atext%2Drendering%3A%20auto%3B%0A%2Dwebkit%2Dfont%2Dsmoothing%3A%20antialiased%3B%0A%2Dmoz%2Dosx%2Dfont%2Dsmoothing%3A%20grayscale%3B%0A%2Dwebkit%2Duser%2Dselect%3A%20none%3B%0A%2Dmoz%2Duser%2Dselect%3A%20none%3B%0A%2Dms%2Duser%2Dselect%3A%20none%3B%0Auser%2Dselect%3A%20none%3B%0A%7D%0A%2Eocticon%2Dlink%3Abefore%20%7B%0Acontent%3A%20%27%5Cf05c%27%3B%0A%7D%0A%2Emarkdown%2Dbody%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%20%21important%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%20%21important%3B%0A%7D%0Aa%3Anot%28%5Bhref%5D%29%20%7B%0Acolor%3A%20inherit%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0A%2Eanchor%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%2Dright%3A%202px%3B%0Amargin%2Dleft%3A%20%2D18px%3B%0A%7D%0A%2Eanchor%3Afocus%20%7B%0Aoutline%3A%20none%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%201em%3B%0Amargin%2Dbottom%3A%2016px%3B%0Afont%2Dweight%3A%20bold%3B%0Aline%2Dheight%3A%201%2E4%3B%0A%7D%0Ah1%20%2Eocticon%2Dlink%2C%0Ah2%20%2Eocticon%2Dlink%2C%0Ah3%20%2Eocticon%2Dlink%2C%0Ah4%20%2Eocticon%2Dlink%2C%0Ah5%20%2Eocticon%2Dlink%2C%0Ah6%20%2Eocticon%2Dlink%20%7B%0Acolor%3A%20%23000%3B%0Avertical%2Dalign%3A%20middle%3B%0Avisibility%3A%20hidden%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%2C%0Ah2%3Ahover%20%2Eanchor%2C%0Ah3%3Ahover%20%2Eanchor%2C%0Ah4%3Ahover%20%2Eanchor%2C%0Ah5%3Ahover%20%2Eanchor%2C%0Ah6%3Ahover%20%2Eanchor%20%7B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah2%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah3%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah4%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah5%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah6%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%20%7B%0Avisibility%3A%20visible%3B%0A%7D%0Ah1%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%202%2E25em%3B%0Aline%2Dheight%3A%201%2E2%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah1%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah2%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%201%2E75em%3B%0Aline%2Dheight%3A%201%2E225%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah2%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0Aline%2Dheight%3A%201%2E43%3B%0A%7D%0Ah3%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E25em%3B%0A%7D%0Ah4%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ah5%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%201em%3B%0Acolor%3A%20%23777%3B%0A%7D%0Ah6%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ap%2C%0Ablockquote%2C%0Aul%2C%0Aol%2C%0Adl%2C%0Atable%2C%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%204px%3B%0Apadding%3A%200%3B%0Amargin%3A%2016px%200%3B%0Abackground%2Dcolor%3A%20%23e7e7e7%3B%0Aborder%3A%200%20none%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%2Dleft%3A%202em%3B%0A%7D%0Aul%20ul%2C%0Aul%20ol%2C%0Aol%20ol%2C%0Aol%20ul%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Ali%3Ep%20%7B%0Amargin%2Dtop%3A%2016px%3B%0A%7D%0Adl%20%7B%0Apadding%3A%200%3B%0A%7D%0Adl%20dt%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%2016px%3B%0Afont%2Dsize%3A%201em%3B%0Afont%2Dstyle%3A%20italic%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Adl%20dd%20%7B%0Apadding%3A%200%2016px%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ablockquote%20%7B%0Apadding%3A%200%2015px%3B%0Acolor%3A%20%23777%3B%0Aborder%2Dleft%3A%204px%20solid%20%23ddd%3B%0A%7D%0Ablockquote%3E%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Ablockquote%3E%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Atable%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Aoverflow%3A%20auto%3B%0Aword%2Dbreak%3A%20normal%3B%0Aword%2Dbreak%3A%20keep%2Dall%3B%0A%7D%0Atable%20th%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Atable%20th%2C%0Atable%20td%20%7B%0Apadding%3A%206px%2013px%3B%0Aborder%3A%201px%20solid%20%23ddd%3B%0A%7D%0Atable%20tr%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ccc%3B%0A%7D%0Atable%20tr%3Anth%2Dchild%282n%29%20%7B%0Abackground%2Dcolor%3A%20%23f8f8f8%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0A%7D%0Acode%20%7B%0Apadding%3A%200%3B%0Apadding%2Dtop%3A%200%2E2em%3B%0Apadding%2Dbottom%3A%200%2E2em%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%2085%25%3B%0Abackground%2Dcolor%3A%20rgba%280%2C0%2C0%2C0%2E04%29%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0Acode%3Abefore%2C%0Acode%3Aafter%20%7B%0Aletter%2Dspacing%3A%20%2D0%2E2em%3B%0Acontent%3A%20%22%5C00a0%22%3B%0A%7D%0Apre%3Ecode%20%7B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%20100%25%3B%0Aword%2Dbreak%3A%20normal%3B%0Awhite%2Dspace%3A%20pre%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0A%2Ehighlight%20%7B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0A%2Ehighlight%20pre%2C%0Apre%20%7B%0Apadding%3A%2016px%3B%0Aoverflow%3A%20auto%3B%0Afont%2Dsize%3A%2085%25%3B%0Aline%2Dheight%3A%201%2E45%3B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0A%2Ehighlight%20pre%20%7B%0Amargin%2Dbottom%3A%200%3B%0Aword%2Dbreak%3A%20normal%3B%0A%7D%0Apre%20%7B%0Aword%2Dwrap%3A%20normal%3B%0A%7D%0Apre%20code%20%7B%0Adisplay%3A%20inline%3B%0Amax%2Dwidth%3A%20initial%3B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Aoverflow%3A%20initial%3B%0Aline%2Dheight%3A%20inherit%3B%0Aword%2Dwrap%3A%20normal%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0Apre%20code%3Abefore%2C%0Apre%20code%3Aafter%20%7B%0Acontent%3A%20normal%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%2Dsize%3A%2011px%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Epl%2Dc%20%7B%0Acolor%3A%20%23969896%3B%0A%7D%0A%2Epl%2Dc1%2C%0A%2Epl%2Ds%20%2Epl%2Dv%20%7B%0Acolor%3A%20%230086b3%3B%0A%7D%0A%2Epl%2De%2C%0A%2Epl%2Den%20%7B%0Acolor%3A%20%23795da3%3B%0A%7D%0A%2Epl%2Ds%20%2Epl%2Ds1%2C%0A%2Epl%2Dsmi%20%7B%0Acolor%3A%20%23333%3B%0A%7D%0A%2Epl%2Dent%20%7B%0Acolor%3A%20%2363a35c%3B%0A%7D%0A%2Epl%2Dk%20%7B%0Acolor%3A%20%23a71d5d%3B%0A%7D%0A%2Epl%2Dpds%2C%0A%2Epl%2Ds%2C%0A%2Epl%2Ds%20%2Epl%2Dpse%20%2Epl%2Ds1%2C%0A%2Epl%2Dsr%2C%0A%2Epl%2Dsr%20%2Epl%2Dcce%2C%0A%2Epl%2Dsr%20%2Epl%2Dsra%2C%0A%2Epl%2Dsr%20%2Epl%2Dsre%20%7B%0Acolor%3A%20%23183691%3B%0A%7D%0A%2Epl%2Dv%20%7B%0Acolor%3A%20%23ed6a43%3B%0A%7D%0A%2Epl%2Did%20%7B%0Acolor%3A%20%23b52a1d%3B%0A%7D%0A%2Epl%2Dii%20%7B%0Abackground%2Dcolor%3A%20%23b52a1d%3B%0Acolor%3A%20%23f8f8f8%3B%0A%7D%0A%2Epl%2Dsr%20%2Epl%2Dcce%20%7B%0Acolor%3A%20%2363a35c%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dml%20%7B%0Acolor%3A%20%23693a17%3B%0A%7D%0A%2Epl%2Dmh%2C%0A%2Epl%2Dmh%20%2Epl%2Den%2C%0A%2Epl%2Dms%20%7B%0Acolor%3A%20%231d3e81%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmq%20%7B%0Acolor%3A%20%23008080%3B%0A%7D%0A%2Epl%2Dmi%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0A%2Epl%2Dmb%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmd%20%7B%0Abackground%2Dcolor%3A%20%23ffecec%3B%0Acolor%3A%20%23bd2c00%3B%0A%7D%0A%2Epl%2Dmi1%20%7B%0Abackground%2Dcolor%3A%20%23eaffea%3B%0Acolor%3A%20%2355a532%3B%0A%7D%0A%2Epl%2Dmdr%20%7B%0Acolor%3A%20%23795da3%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmo%20%7B%0Acolor%3A%20%231d3e81%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%3A%2011px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20%7B%0Alist%2Dstyle%2Dtype%3A%20none%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%2B%2Etask%2Dlist%2Ditem%20%7B%0Amargin%2Dtop%3A%203px%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20input%20%7B%0Amargin%3A%200%200%2E35em%200%2E25em%20%2D1%2E6em%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0A%3Achecked%2B%2Eradio%2Dlabel%20%7B%0Az%2Dindex%3A%201%3B%0Aposition%3A%20relative%3B%0Aborder%2Dcolor%3A%20%234078c0%3B%0A%7D%0A%2EsourceLine%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0A%7D%0Acode%20%2Ekw%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Edt%20%7B%20color%3A%20%23ed6a43%3B%20%7D%0Acode%20%2Edv%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ebn%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Efl%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ech%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Est%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eco%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Eot%20%7B%20color%3A%20%230086b3%3B%20%7D%0Acode%20%2Eal%20%7B%20color%3A%20%23a61717%3B%20%7D%0Acode%20%2Efu%20%7B%20color%3A%20%2363a35c%3B%20%7D%0Acode%20%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%0Acode%20%2Ewa%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ecn%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Esc%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Evs%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Ess%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eim%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eva%20%7Bcolor%3A%20%23008080%3B%20%7D%0Acode%20%2Ecf%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eop%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ebu%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eex%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Epp%20%7B%20color%3A%20%23999999%3B%20%7D%0Acode%20%2Eat%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Edo%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Ean%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ecv%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ein%20%7B%20color%3A%20%23008080%3B%20%7D%0A">
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="ncaa-simulation">NCAA Simulation</h1>
<p>Andrew Couch 3/6/2022</p>
<h1 id="2022-ncaa-march-madness-simulation">2022 NCAA March Madness Simulation</h1>
<p>Written in R and Developed by <a href="https://www.linkedin.com/in/andrew-couch/">Andrew Couch</a></p>
<h2 id="description">Description</h2>
<p>A short simulation was created for an entry to my works’ march madness bracket. The simulation uses ELO scores that were created from the most recent basketball season. I decided to simulate the march madness bracket since I do not know anything about college sports and basketball. The simulation uses a Monte Carlo simulation with the ELO scores that update throughout the bracket.</p>
<h2 id="code-for-the-simulation">Code for the simulation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(progress)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(elo)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in NCAA basketball season history </span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">files =</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">&quot;Data&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">files =</span> <span class="fu">paste0</span>(<span class="st">&quot;Data/&quot;</span>, files),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> <span class="fu">map</span>(files, read_csv, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean team names </span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, game_id, files, opponent, team_score, opp_score) <span class="sc">%&gt;%</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">files =</span> <span class="fu">str_replace</span>(files, <span class="st">&quot;_schedule.csv&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">files =</span> <span class="fu">str_replace</span>(files, <span class="st">&quot;Data</span><span class="sc">\\</span><span class="st">/&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">team =</span> files, <span class="at">opp =</span> opponent) <span class="sc">%&gt;%</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">team =</span> <span class="fu">str_replace_all</span>(team, <span class="st">&quot;_|-&quot;</span>, <span class="st">&quot; &quot;</span>),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">team =</span> <span class="fu">str_replace</span>(team, <span class="st">&quot;St&quot;</span>, <span class="st">&quot;State&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace</span>(<span class="st">&quot;Stateate&quot;</span>, <span class="st">&quot;State&quot;</span>),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">opp =</span> <span class="fu">str_replace_all</span>(opp, <span class="st">&quot;_|-&quot;</span>, <span class="st">&quot; &quot;</span>),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">opp =</span> <span class="fu">str_replace</span>(opp, <span class="st">&quot;St&quot;</span>, <span class="st">&quot;State&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace</span>(<span class="st">&quot;Stateate&quot;</span>, <span class="st">&quot;State&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly sample from each game (pairwise head-to-head ex. A vs. B and B vs. A)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>match_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(game_id) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute ending elo for the season to use in simulation </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>start_elo <span class="ot">&lt;-</span> <span class="fu">elo.run</span>(<span class="fu">score</span>(team_score, opp_score) <span class="sc">~</span> team <span class="sc">+</span> opp, <span class="at">data =</span> match_df, <span class="at">k =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">final.elos</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;team&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">elo =</span> value)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframes for each division for teams in March Madness bracket</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Bracket used: https://www.espn.com/espn/feature/story/_/page/bracketology/ncaa-bracketology-projecting-2022-march-madness-men-field</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Some teams are still playing for bracket and max elo is used to choose teams (will change or not)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>south_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">div =</span> <span class="st">&quot;south&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">team =</span> <span class="fu">c</span>(<span class="st">&quot;Baylor&quot;</span>, <span class="st">&quot;Norfolk State&quot;</span>, <span class="st">&quot;Marquette&quot;</span>, <span class="st">&quot;Miami&quot;</span>, <span class="st">&quot;UConn&quot;</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Head to head &quot;Rutgers&quot;, &quot;Loyola Chicago&quot;, </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Loyola Chicago&quot;</span>, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Houston&quot;</span>, <span class="st">&quot;Toledo&quot;</span>, <span class="st">&quot;Ohio State&quot;</span>, <span class="st">&quot;Davidson&quot;</span>, <span class="st">&quot;Tennessee&quot;</span>, <span class="st">&quot;Texas State&quot;</span>, <span class="st">&quot;Boise State&quot;</span>, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;San Francisco&quot;</span>, <span class="st">&quot;Duke&quot;</span>, <span class="st">&quot;Colgate&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                   ))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>midwest_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">div =</span> <span class="st">&quot;mdiwest&quot;</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">team =</span> <span class="fu">c</span>(<span class="st">&quot;Arizona&quot;</span>, <span class="st">&quot;Long Beach State&quot;</span>, <span class="st">&quot;TCU&quot;</span>, <span class="st">&quot;Murray State&quot;</span>, <span class="st">&quot;Texas&quot;</span>, <span class="st">&quot;Chattanooga&quot;</span>, <span class="st">&quot;Providence&quot;</span>, <span class="st">&quot;Iona&quot;</span>, <span class="st">&quot;LSU&quot;</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Wyoming&quot;</span>, <span class="st">&quot;Purdue&quot;</span>, <span class="st">&quot;Northern Iowa&quot;</span>, <span class="st">&quot;USC&quot;</span>, <span class="st">&quot;San Diego State&quot;</span>, <span class="st">&quot;Kansas&quot;</span>, <span class="st">&quot;Jacksonville State&quot;</span>))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>west_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">div =</span> <span class="st">&quot;west&quot;</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">team =</span> <span class="fu">c</span>(<span class="st">&quot;Gonzaga&quot;</span>, </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># Head to head &quot;New Orleans&quot;, &quot;Alcorn State&quot;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;New Orleans&quot;</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Iowa State&quot;</span>, <span class="st">&quot;Creighton&quot;</span>, <span class="st">&quot;Alabama&quot;</span>, <span class="st">&quot;South Dakota State&quot;</span>, <span class="st">&quot;UCLA&quot;</span>, <span class="st">&quot;Towson&quot;</span>, <span class="st">&quot;Saint Mary&#39;s&quot;</span>, <span class="st">&quot;Michigan&quot;</span>, <span class="st">&quot;Texas Tech&quot;</span>, </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Seattle&quot;</span>, <span class="st">&quot;Colorado State&quot;</span>, <span class="st">&quot;North Carolina&quot;</span>, <span class="st">&quot;Wisconsin&quot;</span>, <span class="st">&quot;Montana State&quot;</span>))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>east_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">div =</span> <span class="st">&quot;east&quot;</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">team =</span> <span class="fu">c</span>(<span class="st">&quot;Auburn&quot;</span>, </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># Head to head&quot;Cleveland State&quot;, &quot;Bryant&quot;, </span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Bryant&quot;</span>, </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Seton Hall&quot;</span>, <span class="st">&quot;Wake Forest&quot;</span>, <span class="st">&quot;Arkansas&quot;</span>, <span class="st">&quot;North Texas&quot;</span>, <span class="st">&quot;Illinois&quot;</span>, <span class="st">&quot;Vermont&quot;</span>, <span class="st">&quot;Iowa&quot;</span>, </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># Head to Head? &quot;Xavier&quot;, &quot;Memphis&quot;, </span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Memphis&quot;</span>, </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Villanova&quot;</span>, <span class="st">&quot;Princeton&quot;</span>, <span class="st">&quot;Michigan State&quot;</span>, <span class="st">&quot;Notre Dame&quot;</span>, <span class="st">&quot;Kentucky&quot;</span>, <span class="st">&quot;Longwood&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function for simulating a tournament </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>simulate_tournament <span class="ot">&lt;-</span> <span class="cf">function</span>(trials){</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a helper function to simulate each division winners </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  simulate_div <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate round 1 </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    round1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Join starting elo </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inner_join</span>(start_elo, <span class="at">by =</span> <span class="st">&quot;team&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Start First round </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">round =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">8</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">round =</span> <span class="fu">cumsum</span>(round),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">team_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;team&quot;</span>, <span class="st">&quot;opp&quot;</span>), <span class="dv">8</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create head to head </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> team_type, <span class="at">values_from =</span> <span class="fu">c</span>(team, elo)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Compute elo probability </span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">team_prob =</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span>  <span class="dv">10</span><span class="sc">^</span>((elo_opp <span class="sc">-</span> elo_team)<span class="sc">/</span> <span class="dv">400</span>)),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>             <span class="co"># Simulate outcome</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">outcome =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">n</span>()),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">&lt;=</span> team_prob, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>             <span class="co"># Compute elo change </span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo_team =</span> elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo_opp =</span> elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob),</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>             <span class="co"># Find the winning team and new elo</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">team =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, team_team, team_opp),</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                           elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                           elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob)))</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate round 2 </span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    round2 <span class="ot">&lt;-</span> round1 <span class="sc">%&gt;%</span> </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(div, round, team, elo) <span class="sc">%&gt;%</span> </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Start second round </span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">round =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">4</span>),</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">round =</span> <span class="fu">cumsum</span>(round),</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">team_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;team&quot;</span>, <span class="st">&quot;opp&quot;</span>), <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> team_type, <span class="at">values_from =</span> <span class="fu">c</span>(team, elo)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">team_prob =</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span>  <span class="dv">10</span><span class="sc">^</span>((elo_opp <span class="sc">-</span> elo_team)<span class="sc">/</span> <span class="dv">400</span>)),</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">outcome =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">n</span>()),</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">&lt;=</span> team_prob, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo_team =</span> elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo_opp =</span> elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob),</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">team =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, team_team, team_opp),</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>                           elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>                           elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob)))</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate round three </span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    round3 <span class="ot">&lt;-</span> round2 <span class="sc">%&gt;%</span> </span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(div, round, team, elo) <span class="sc">%&gt;%</span> </span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">round =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">2</span>),</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">round =</span> <span class="fu">cumsum</span>(round),</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">team_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;team&quot;</span>, <span class="st">&quot;opp&quot;</span>), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> team_type, <span class="at">values_from =</span> <span class="fu">c</span>(team, elo)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">team_prob =</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span>  <span class="dv">10</span><span class="sc">^</span>((elo_opp <span class="sc">-</span> elo_team)<span class="sc">/</span> <span class="dv">400</span>)),</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">outcome =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">n</span>()),</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>             <span class="at">outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">&lt;=</span> team_prob, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo_team =</span> elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo_opp =</span> elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>             <span class="at">team =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, team_team, team_opp),</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>                           elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>                           elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob))) </span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate round four </span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    round4 <span class="ot">&lt;-</span> round3 <span class="sc">%&gt;%</span> </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(div, round, team, elo) <span class="sc">%&gt;%</span> </span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">round =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">1</span>),</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>             <span class="at">round =</span> <span class="fu">cumsum</span>(round),</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>             <span class="at">team_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;team&quot;</span>, <span class="st">&quot;opp&quot;</span>), <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> team_type, <span class="at">values_from =</span> <span class="fu">c</span>(team, elo)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">team_prob =</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span>  <span class="dv">10</span><span class="sc">^</span>((elo_opp <span class="sc">-</span> elo_team)<span class="sc">/</span> <span class="dv">400</span>)),</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>             <span class="at">outcome =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">n</span>()),</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>             <span class="at">outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">&lt;=</span> team_prob, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo_team =</span>elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo_opp =</span> elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob),</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>             <span class="at">team =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, team_team, team_opp),</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>             <span class="at">elo =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>                           elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>                           elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob)))</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine each round&#39;s results </span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>    div_hist_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>      round1 <span class="sc">%&gt;%</span> </span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="at">team =</span> team_team, elo_team, <span class="at">opp =</span> team_opp, elo_opp, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">round =</span> <span class="dv">1</span>),</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>      round2 <span class="sc">%&gt;%</span> </span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="at">team =</span> team_team, elo_team, <span class="at">opp =</span> team_opp, elo_opp, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">round =</span> <span class="dv">2</span>),</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>      round3 <span class="sc">%&gt;%</span> </span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="at">team =</span> team_team, elo_team, <span class="at">opp =</span> team_opp, elo_opp, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">round =</span> <span class="dv">3</span>),</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>      round4 <span class="sc">%&gt;%</span> </span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="at">team =</span> team_team, elo_team, <span class="at">opp =</span> team_opp, elo_opp, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">round =</span> <span class="dv">4</span>)</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine simulated history of division with the winner of the division </span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>(round4 <span class="sc">%&gt;%</span> <span class="fu">select</span>(team, elo), <span class="at">data =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">winner =</span> data) <span class="sc">%&gt;%</span> </span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_cols</span>(<span class="fu">nest</span>(div_hist_df, <span class="at">data =</span> <span class="fu">everything</span>())) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">history =</span> data)</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>  pb<span class="sc">$</span><span class="fu">tick</span>()</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate each divisions results and winner</span></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">data =</span> <span class="fu">list</span>(west_df, east_df, midwest_df, south_df)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">res =</span> <span class="fu">map</span>(data, simulate_div)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(res)) </span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate the semi finals </span></span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># could use helper function for more tidier version but would need to create functions to aggregate results of winners </span></span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>  <span class="co"># resulting in a lot of nested data frames and slowness in simulations (planning on simulating 10,000 times)</span></span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>  semi_final <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(winner) <span class="sc">%&gt;%</span> </span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(winner)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">round =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">2</span>),</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>           <span class="at">round =</span> <span class="fu">cumsum</span>(round),</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>           <span class="at">team_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;team&quot;</span>, <span class="st">&quot;opp&quot;</span>), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> team_type, <span class="at">values_from =</span> <span class="fu">c</span>(team, elo)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">team_prob =</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span>  <span class="dv">10</span><span class="sc">^</span>((elo_opp <span class="sc">-</span> elo_team)<span class="sc">/</span> <span class="dv">400</span>)),</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>           <span class="at">outcome =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">n</span>()),</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>           <span class="at">elo_team =</span> elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>           <span class="at">elo_opp =</span> elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob),</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>           <span class="at">outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">&lt;=</span> team_prob, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>           <span class="at">team =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, team_team, team_opp),</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>           <span class="at">elo =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>                         elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>                         elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob))) </span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create holder for semi final history </span></span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>  hist <span class="ot">&lt;-</span> semi_final <span class="sc">%&gt;%</span>   </span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">team =</span> team_team, elo_team, <span class="at">opp =</span> team_opp, elo_opp, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">round =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">history =</span> data)</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create holder for semi final winners </span></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>  winner <span class="ot">&lt;-</span> semi_final <span class="sc">%&gt;%</span> </span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(team, elo) <span class="sc">%&gt;%</span> </span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">winner =</span> data)</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Append simulation history and winner division history and winners </span></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, <span class="fu">bind_cols</span>(hist, winner))</span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate the finals </span></span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>  final <span class="ot">&lt;-</span> winner <span class="sc">%&gt;%</span> </span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(winner)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">round =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">1</span>),</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>           <span class="at">round =</span> <span class="fu">cumsum</span>(round),</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>           <span class="at">team_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;team&quot;</span>, <span class="st">&quot;opp&quot;</span>), <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> team_type, <span class="at">values_from =</span> <span class="fu">c</span>(team, elo)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">team_prob =</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span>  <span class="dv">10</span><span class="sc">^</span>((elo_opp <span class="sc">-</span> elo_team)<span class="sc">/</span> <span class="dv">400</span>)),</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>           <span class="at">outcome =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">n</span>()),</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>           <span class="at">outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">&lt;=</span> team_prob, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>           <span class="at">elo_team =</span> elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>           <span class="at">elo_opp =</span> elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob),</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>           <span class="at">team =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, team_team, team_opp),</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>           <span class="at">elo =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>                         elo_team <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob), </span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>                         elo_opp <span class="sc">-</span> <span class="dv">20</span><span class="sc">*</span>(outcome <span class="sc">-</span> team_prob)))</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create holder for final history</span></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a>  hist <span class="ot">&lt;-</span> final <span class="sc">%&gt;%</span>   </span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">team =</span> team_team, elo_team, <span class="at">opp =</span> team_opp, elo_opp, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">round =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">history =</span> data)</span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create holder for final winners </span></span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>  winner <span class="ot">&lt;-</span> final <span class="sc">%&gt;%</span> </span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(team, elo) <span class="sc">%&gt;%</span> </span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">winner =</span> data) </span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Append simulation history and winner to division and semi final history and winners </span></span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, <span class="fu">bind_cols</span>(hist, winner))</span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert/Aggregate the nested dataframes to two nested data frames (history and winners)</span></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a>  <span class="co"># May have a function that would make it easier</span></span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(history) <span class="sc">%&gt;%</span></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(history)) <span class="sc">%&gt;%</span></span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>      <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">history =</span> data),</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(winner) <span class="sc">%&gt;%</span></span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(winner)) <span class="sc">%&gt;%</span></span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>      <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">winner =</span> data)</span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>pb <span class="ot">&lt;-</span> progress_bar<span class="sc">$</span><span class="fu">new</span>(<span class="at">total =</span> <span class="dv">10000</span>, <span class="at">format =</span> <span class="st">&quot;[:bar] :current/:total (:percent)&quot;</span>)</span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trials =</span> <span class="fu">seq.int</span>(<span class="dv">1</span>, <span class="dv">10000</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sim =</span> <span class="fu">map</span>(trials, simulate_tournament))</span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(res, <span class="at">file =</span> <span class="st">&quot;ncaa_sim.RDS&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in simulation </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&quot;ncaa_sim.RDS&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>res_df <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(sim) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(trials, history) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(history) </span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get top 10 teams who win the simulated finals </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  res_df <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(trials, round, team, outcome),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  res_df <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(trials, round, <span class="at">team =</span> opp, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(outcome <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> round <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(outcome)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(total, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(team, total) <span class="sc">%&gt;%</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total))</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    team               total
##    &lt;chr&gt;              &lt;dbl&gt;
##  1 Murray State         413
##  2 Gonzaga              400
##  3 Arizona              335
##  4 Auburn               302
##  5 North Texas          268
##  6 Duke                 265
##  7 South Dakota State   265
##  8 Houston              257
##  9 Kansas               256
## 10 Providence           230</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View round probabilities for top 5 teams who make it to the final round</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  res_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(trials, round, team, outcome),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  res_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(trials, round, <span class="at">team =</span> opp, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_count</span>(trials) <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team, round, n) <span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(outcome)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> total <span class="sc">/</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(team, round, prob) <span class="sc">%&gt;%</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(team <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Murray State&quot;</span>, <span class="st">&quot;Gonzaga&quot;</span>, <span class="st">&quot;Arizona&quot;</span>, <span class="st">&quot;Auburn&quot;</span>, <span class="st">&quot;North Texas&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> round, <span class="at">y =</span> prob, <span class="at">color =</span> team)) <span class="sc">+</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;team&#39;, &#39;round&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View every team&#39;s round probabilities </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  res_df <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(trials, round, team, outcome),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  res_df <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(trials, round, <span class="at">team =</span> opp, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(round, team) <span class="sc">%&gt;%</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">sum</span>(outcome)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> round, <span class="at">y =</span> freq, <span class="at">group =</span> team)) <span class="sc">+</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;round&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View most likely teams to make it for each round</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  res_df <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(trials, round, team, outcome),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  res_df <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(trials, round, <span class="at">team =</span> opp, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(round, team) <span class="sc">%&gt;%</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">wins =</span> <span class="fu">sum</span>(outcome)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(round) <span class="sc">%&gt;%</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(wins))) <span class="sc">%&gt;%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">2</span><span class="sc">^</span>(<span class="dv">6</span> <span class="sc">-</span> round)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(round, rank)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;round&#39;. You can override using the `.groups` argument.

## # A tibble: 64 x 4
##    round team                wins  rank
##    &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;int&gt;
##  1     1 Gonzaga             6828     1
##  2     1 Murray State        6685     2
##  3     1 Arizona             6602     3
##  4     1 Colorado State      6379     4
##  5     1 Saint Mary&#39;s        6189     5
##  6     1 South Dakota State  6113     6
##  7     1 Auburn              6105     7
##  8     1 Duke                6088     8
##  9     1 Purdue              6013     9
## 10     1 Kansas              5992    10
## # ... with 54 more rows</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute head to head probabilities from simulation</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>res_df <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">opp_outcome =</span> <span class="fu">if_else</span>(outcome <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">team_a =</span> <span class="fu">if_else</span>(team <span class="sc">&gt;</span> opp, team, opp),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">team_b =</span> <span class="fu">if_else</span>(team <span class="sc">&gt;</span> opp, opp, team),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">outcome_a =</span> <span class="fu">if_else</span>(team <span class="sc">&gt;</span> opp, outcome, opp_outcome)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(trials, round, team_a, team_b, outcome_a) <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(round, team_a, team_b, outcome_a) <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">outcome_a =</span> <span class="fu">if_else</span>(outcome_a <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;win&quot;</span>, <span class="st">&quot;loss&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> outcome_a, <span class="at">values_from =</span> n, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">win_prob =</span> win <span class="sc">/</span> (win <span class="sc">+</span> loss)) </span></code></pre></div>
<pre><code>## # A tibble: 1,998 x 6
##    round team_a           team_b              loss   win win_prob
##    &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;              &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
##  1     1 Bryant           Auburn              6105  3895    0.390
##  2     1 Duke             Colgate             3912  6088    0.609
##  3     1 Iowa State       Creighton           4961  5039    0.504
##  4     1 Kansas           Jacksonville State  4008  5992    0.599
##  5     1 Long Beach State Arizona             6602  3398    0.340
##  6     1 Longwood         Kentucky            5236  4764    0.476
##  7     1 Memphis          Iowa                5334  4666    0.467
##  8     1 Miami            Marquette           5077  4923    0.492
##  9     1 New Orleans      Gonzaga             6828  3172    0.317
## 10     1 Norfolk State    Baylor              5943  4057    0.406
## # ... with 1,988 more rows</code></pre>

</body>
</html>
